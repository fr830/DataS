<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    	  <link href="/static/favicon.ico" rel="SHORTCUT ICON" />
	  <link rel="apple-touch-icon" href="/static/ico.jpg">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>西门子数据采集</title>

    <meta name="description" content="Source code generated using layoutit.com">
    <meta name="Su600" content="Su">

    <link href="/static/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/css/style.css" rel="stylesheet">
		<style>
		  body {
			  position: relative;} 
		  </style>
</head>
<body>
<nav class="navbar navbar-expand-sm bg-dark navbar-dark fixed-top " id="导航栏">
	
				<a class="navbar-brand" href="#">
					<img src="/static/avic.png" width="35px">
				</a>
  				<a class="navbar-brand" href="/#">Home</a>
                  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
                    <span class="navbar-toggler-icon"></span>
                  </button>
					<div class="collapse navbar-collapse" id="collapsibleNavbar">
						<nav class="nav justify-content-center">
							<a class="btn btn-dark" href="/setting">Back to Setting</a>
						  	<a class="btn btn-dark" href="/logout">Logout</a>
				</div>
</nav>

<div class="container-fluid" style="margin-top:80px" id="说明" >
	<div class="row" >
				<div class="col-sm-4">
					<img class="img-fluid w-100" src="/static/siemens.png" alt="Siemens" />
			</div>
			<div class="col-sm-8" style="text-align: justify;">
					{% with messages = get_flashed_messages(category_filter=["run"]) %}
						{% if messages %}
							{% for message in messages %}
								{% if message%}
									<h5>S7协议采集，写入InfluxDB<span class="badge badge-success">Running</span></h5>		
								{% endif %}
							{% endfor %}
						{% endif %}
					{% endwith %}	
			</div>
		</div>
</div>

		<div class="container-fluid" id="connection">

			<!-- action暂未用到 具体用处暂不清楚 -->
			<!-- action="{{url_for('siemens')}}" -->
			<!-- form-control属性很重要 -->
			<form class="form-inline"  method="POST">
			  <!-- < class="form-inline"> -->
				<label for="ipaddress">IP address：</label>
			  <input type="text" name="ipaddress" value="{{ipaddress}}" class="form-control required" id="ipaddress">
			  <label for="rack" >Rack:</label>
			  <select class="form-control" name="rack" id="rack">
				<option>0</option>
			    <option>1</option>
				<option>2</option>
				<option>3</option>
			  </select>
				<label for="slot" >Slot：</label>
			  <select class="form-control" name="slot" id="slot">
				<option>0</option>
			    <option selected>1</option>
				<option>2</option>
				<option>3</option>
			  </select>	
					<button type="submit" onclick="aa()"  class="btn btn-primary form-control" style="margin: 10px;" >开始连接</button>
					<!-- onclick事件调用的是js 用href通过路由可以调用python程序 -->
					<a href="dis" type="button" class="btn btn-danger form-control"  style="margin: 10px;">断开连接</a>
			
					  {% with messages = get_flashed_messages(category_filter=["connect1"]) %}
					  {% if messages %}
						  {% for message in messages %}
							  <div class="alert alert-success alert-dismissible fade show form-control" style="margin:0px 0px 0px 10px;" role="alert">
								<strong>{{message}}</strong>
								<button type="button" class="close" data-dismiss="alert" aria-label="Close">
								  <span aria-hidden="true">&times;</span>
								</button>
							  </div>
						  {% endfor %}
					  {% endif %}
				  {% endwith %}		

				  {% with messages = get_flashed_messages(category_filter=["connect0"]) %}
				  {% if messages %}
					  {% for message in messages %}
						  <div class="alert alert-danger alert-dismissible fade show form-control" style="margin:0px 0px 0px 10px;" role="alert">
							<strong>{{message}}</strong>
							<button type="button" class="close" data-dismiss="alert" aria-label="Close">
								<span aria-hidden="true">&times;</span>
							  </button>
						</div>		
					  {% endfor %}
				  {% endif %}
			  {% endwith %}	 

			 	<!-- <script>
				window.setTimeout(function(){
					  $('[data-dismiss="alert"]').alert('close');},4000);
				</script> -->
			<!-- 提示框定时消失 -->
			</form>

			<!-- action="{{url_for('s7read')}}"  -->
				<form class="form-inline" method="POST"style="margin-top:20px;" id="iqmselect"> 
					<!-- url_for区分按钮动作的调用函数 -->
					<!-- 表单添加name属性，写入字典 -->
						<label for="iqm">变量选择：</label>
						<select class="form-control" name="iqm" id="iqm">
						<option value="PE">Input</option>
						<option value="PA">Ouput</option>
						<option value="MK">Memory</option>
						</select>
						<label for="address">地址：</label>
						<input type="number" step="0.1" placeholder="0.0" name="address" class="form-control required"id="address">

						<button type="submit" id="read" class="btn btn-outline-primary" >S7 Read</button>
						<button type="button" id="write" class="btn btn-outline-secondary" disabled>S7 Write</button>
						<button type="button" class="btn" style="background-color: teal; color: white; margin-left: 10px;">加入列表</button>
						<!-- <script>
							// function aa() {
							// 	document.getElementById("read").setAttribute("disabled",false);
							// 	document.getElementById("write").setAttribute("disabled",false);
							// }
							
						</script> -->
						
				</form>
			
		</div>	

<div class="container-fluid" style="margin-top:20px;" id="数据结果">
	<div class="row">
		<div class="col-lg-6">
		<h4>数据读取结果</h4>
		<table class="table table-hover ">
			<thead class="thead-dark">
			<tr>
				<th>Time</th>
				<th>Variable</th>
				<th>Value</th>
			</tr>
			</thead>
			<tbody>
			<tr>
				<td> {% with messages = get_flashed_messages(category_filter=["time"]) %}
					{% if messages %}
						{% for message in messages %}
							{{message}}
						{% endfor %}
					{% endif %}
				{% endwith %}		
</td>
				<td>{% with messages = get_flashed_messages(category_filter=["variable"]) %}
					{% if messages %}
						{% for message in messages %}
							{{message}}
						{% endfor %}
					{% endif %}
				{% endwith %}	</td>
				<td>{% with messages = get_flashed_messages(category_filter=["value"]) %}
					{% if messages %}
						{% for message in messages %}
							{{message}}
						{% endfor %}
					{% endif %}
				{% endwith %}	</td>
			</tr>
			<!-- <tr>
				<td>Mary</td>
				<td>Moe</td>
				<td>mary@example.com</td>
			</tr>
			<tr>
				<td>July</td>
				<td>Dooley</td>
				<td>july@example.com</td>
			</tr> -->
			</tbody>
		</table>
		</div>
		

		</iframe>
		
<div class="col-lg-6">
	<h4>
		数据库列表
	</h4>
	<table class="table table-hover " style="background: rgb(169, 185, 201);color: white;">
		<thead class="thead-dark" >
		<tr>
			<th>Variable</th>
			<th>ssss</th>
		</tr>
		</thead>
		<tbody>
			<td>
				aaaa
			</td>
			<td>
				11111
			</td>
			<tbody>
				<td>
				bbbb
			</td>
			<td>
				2222
			</td>
			</tbody>
			
		</tbody>
	</table>
	</div>
</div>
</div>

<div class="container-fluid " style="color: white;" id="influxdbsetting">
	<div class="container-fluid" style="margin:0px;padding:30px ; background:rgb(2, 70, 148);" >
		<form class="form-inline " style="padding: 20px" method="POST"> 
			  <label for="influxdb"><h5>InfluxDB地址：</h5></label>
				<input type="text" name="influxdb" id="influxdb" class="form-control" placeholder="" aria-describedby="InfluxDB">
				<label for="token" ><h5>Token：</h5></label>
				<input type="password" name="token" id="token" class="form-control" placeholder="" aria-describedby="InfluxDB">
				<label for="measurement"><h5>Measurement：</h5></label>
				<input type="text" name="measurement" id="measurement" class="form-control" placeholder="设备名称" aria-describedby="InfluxDB">
				<label for="cycle"><h5>采集周期（ms）</h5></label>
				<input type="text" name="cycle" id="cycle" class="form-control" placeholder="100"  >

				<button class="btn btn-primary form-control"  href="#influxdbsetting" style="padding-block :30px; margin: 10px; " type="submit" id="startinfluxdb">   开始写入   </button>
				<!-- 开始写入后应禁用写入按钮 在页面上方显示运行状态 根据表单字典长度区分表单提交按钮-->
				<a class="btn btn-danger form-control" href="a" style="padding-block: 30px; margin: 10px; " type="button" role="button">   停止写入   </a>
				{% with messages = get_flashed_messages(category_filter=["influx"]) %}
						{% if messages %}
							{% for message in messages %}
								{% if message%}
									<p><span class="badge badge-success">开始写入</span></p>		
								{% endif %}
							{% endfor %}
						{% endif %}
					{% endwith %}	
					<!-- <a name="" id="" class="btn btn-primary" href="#" role="button"></a> -->
			</form>	
	</div>	
	<!-- <div class="container-fluid" style="margin:0px ; background:rgb(2, 70, 148);" >
			<div class="form-inline" style="padding:20px" method="POST">
				<label for="field"><h6>Field：</h6></label>
					<input type="text"  id="field" class="form-control" placeholder="默认即为变量名" aria-describedby="InfluxDB">
					<label for="tag"><h6>Tag：</h6></label>
					<input type="text"  id="tag" class="form-control" placeholder="" aria-describedby="InfluxDB">
					
			</div>
	</div> -->
</div>

<div class="container-fluid"style="margin-top:20px" id="页脚">
		<footer style="text-align:center ">
			<div class="progress" style="height:10px; ">
				<div class="progress-bar" style="width:33.33%">
					<!--Free Space-->
				</div>
				<div class="progress-bar bg-warning" style="width:33.33%">
					<!--Warning-->
				</div>
				<div class="progress-bar bg-danger" style="width:33.33%">
					<!--Danger-->
				</div>
			</div>
				<p style="padding-top:10px" >
					<!--<kbd>-->
						Copyright © 2020 Su600, Inc.
					<!--</kbd>-->
				</p>
		</footer>
</div>


<script>
/**
 * 新增一行数据
 */
function addRow(){
    var count = $('#table_add').bootstrapTable('getData').length;
    // newFlag == 1的数据为新规的数据
    $('#table_add').bootstrapTable('insertRow',{index:count,row:{newFlag:"1"}});
}

</script>

<!-- <script>

    //声明全局数组，用于存放取值
    var inputArr = document.getElementById("ipaddress");

    function check(o)
    {
        var nameStr = "";
        for (var i = 0; i < inputArr.length-1; i++)
        {
            nameStr += inputArr[i].value + ";";
        }
        nameStr += inputArr[inputArr.length - 1];
        window.name = nameStr;
    }

    if (window.name)
    {
        //声明数组，用于存放从window.name中分离出的值
        var nameArr = new Array();
        nameArr = window.name.split(";");

        for (var i = 0; i < nameArr.length; i++)
        {
            if (inputArr[i].type == "text")
            {
                inputArr[i].value = nameArr[i];
            }
        }
    }
</script> -->

		<script src="/static/js/jquery.min.js"></script>
		<script src="/static/js/bootstrap.min.js"></script>
		<script src="/static/js/scripts.js"></script>


</body>
</html>